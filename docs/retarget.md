# **Simple Retargeting**

- 가정: 인간의 신체 즉, 포즈는 각도만 변함

- 애니메이션과 그 애니메이션을 적용하려는 캐릭터
  - AB = 애니메이션 바인딩 포즈 (로컬)
  - ABg = 애니메이션 바인딩 포즈 (글로벌)
  - AR = 애니메이션 바인딩 포즈의 상대적인 각도
  - AA = 애니메이션 데이터
    - AA = AB X AR
  - CB = 캐릭터의 바인딩 포즈 (로컬)
  - CA = 캐릭터에 적용하려는 애니메이션 데이터
    

## **Same bone structure Same pose**

- 이름과 본의 계층구조가 같을 때
- 팔 다리 등이 겹치는, 기존 애니메이션에 없는 관통 문제가 있음

### **Same bone orientation but different ratio**

- 바인딩 포즈의 각각의 본 좌표계의 각도가 같지만, 캐릭터의 비율이 다를 때
  - 애니메이션 데이터에서 바인딩 포즈 데이터를 제거
  - 적용하려는 캐릭터의 바인딩 포즈로 대체

- 식은 다음과 같음
  - CA = CB X (AB)^-1 X AB X AR
  - CA = CB x AR

### **Different bone orientation and ratio**

이 경우, 애니메이션 바인딩 포즈의 상대적 각도를 수정할 필요가 있음

- NAB = 새로운 애니메이션 바인딩 포즈 로컬
- NABg = 새로운 애니메이션 바인딩 포즈 글로벌
- NAR = 새로운 애니메이션 바인딩 포즈의 상대적인 각도

1. 애니메이션 바인딩 포즈를 캐릭터 바인딩 포즈와 일치
    - dfs 알고리즘으로 루트에서 리프까지 탐색
        - TRS: 위치, 회전, 크기 변환
        - 루트: 캐릭터 로컬 바인딩 포즈의 TRS로 본 좌표계 대체, 해당 본 좌표계에서 상대적인 자식 본의 위치 좌표 구함
        - 자식 본: T 를 부모에서 계산한 위치로, RS 는  캐릭터 로컬 바인딩 포즈로 대체, 해당 본 좌표계에서 자식 본의 자식의 위치 좌표를 구함

2. 새로운 바인딩 포즈를 적용한 식과 이전의 바인딩 포즈 식으로 방정식을 세움
    - 루트: 
        - $$AB * AR * (ABg)^-1 = NAB * NAR * (NABg)^-1$$
        - $$NAR = (NAB)^-1 * AB * AR * (ABg)^-1 * (NABg) $$
    - 자식:
        - $$Parent * AB * AR * (ABg)^-1 = NParent * NAB * NAR * (NABg)^-1$$
        - $$NAR = (NAB)^-1 * (NParent)^-1 * Parent * AB * AR * (ABg)^-1 * (NABg)$$